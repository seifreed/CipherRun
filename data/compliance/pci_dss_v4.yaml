id: pci-dss-v4
name: PCI-DSS v4.0.1
version: 4.0.1
description: Payment Card Industry Data Security Standard v4.0.1
organization: PCI Security Standards Council
effective_date: 2024-03-31

requirements:
  - id: PCI-4.2.1
    name: Strong Cryptography - TLS 1.2+
    description: Only TLS 1.2 and TLS 1.3 permitted for cardholder data transmission
    category: Protocol Security
    severity: critical
    remediation: |
      Disable SSLv2, SSLv3, TLS 1.0, and TLS 1.1 on all systems that transmit or process cardholder data.
      Configure servers to accept only TLS 1.2 and TLS 1.3 connections.
      Update application configurations and load balancers accordingly.
    rules:
      - type: ProtocolVersion
        allowed:
          - TLS 1.2
          - TLS 1.3
        denied:
          - SSLv2
          - SSLv3
          - TLS 1.0
          - TLS 1.1

  - id: PCI-4.2.2
    name: Weak Cipher Prohibition
    description: Weak ciphers and encryption methods must not be used
    category: Cipher Security
    severity: critical
    remediation: |
      Remove and disable all weak cipher suites including:
      - NULL ciphers (provide no encryption)
      - EXPORT ciphers (intentionally weakened for export)
      - DES and 3DES (obsolete encryption)
      - RC4 (broken stream cipher)
      - MD5-based ciphers (weak hash function)

      Configure servers to use only strong AEAD ciphers such as AES-GCM or ChaCha20-Poly1305.
    rules:
      - type: CipherSuite
        denied_patterns:
          - ".*_NULL_.*"
          - ".*_EXPORT_.*"
          - ".*_DES_CBC_.*"
          - ".*_3DES_EDE_CBC_.*"
          - ".*_RC4_.*"
          - ".*_MD5$"
          - ".*_MD5_.*"

  - id: PCI-4.2.3
    name: Strong Key Exchange
    description: Forward secrecy is required for all cipher suites
    category: Cipher Security
    severity: high
    remediation: |
      Enable only cipher suites that provide forward secrecy (Perfect Forward Secrecy - PFS).
      Use ECDHE or DHE key exchange mechanisms.
      Disable static RSA key exchange cipher suites.
    rules:
      - type: ForwardSecrecy
        required: true

  - id: PCI-4.2.4
    name: Certificate Key Strength
    description: Minimum 2048-bit RSA or 256-bit ECC keys required
    category: Certificate Security
    severity: high
    remediation: |
      Generate new certificates with:
      - RSA keys of at least 2048 bits (4096 bits recommended)
      - ECC keys of at least 256 bits (384 bits recommended)

      Replace any certificates using weaker keys immediately.
    rules:
      - type: CertificateKeySize
        min_rsa_bits: 2048
        min_ecc_bits: 256

  - id: PCI-4.2.5
    name: Secure Signature Algorithm
    description: SHA-2 family or better required for certificate signatures
    category: Certificate Security
    severity: high
    remediation: |
      Replace certificates using weak signature algorithms (MD5, SHA-1) with certificates signed using:
      - SHA-256
      - SHA-384
      - SHA-512

      Update your Certificate Authority configuration to use SHA-2 or better.
    rules:
      - type: SignatureAlgorithm
        allowed:
          - sha256
          - sha384
          - sha512
        denied:
          - md5
          - sha1

  - id: PCI-4.2.6
    name: Valid Certificate Chain
    description: Certificate must have a valid trust chain to a trusted root CA
    category: Certificate Security
    severity: critical
    remediation: |
      Ensure certificates are issued by trusted Certificate Authorities.
      Install complete certificate chain including intermediate certificates.
      Verify certificate chain validation succeeds before deployment.
    rules:
      - type: CertificateValidation
        require_valid_chain: true
        require_unexpired: true
        require_hostname_match: true

  - id: PCI-4.2.7
    name: Strong AEAD Ciphers
    description: Authenticated encryption with associated data (AEAD) ciphers preferred
    category: Cipher Security
    severity: medium
    remediation: |
      Prioritize AEAD cipher suites:
      - AES-GCM (AES in Galois/Counter Mode)
      - ChaCha20-Poly1305

      These provide both confidentiality and authenticity.
    rules:
      - type: CipherSuite
        preferred_patterns:
          - ".*_GCM$"
          - ".*_GCM_.*"
          - ".*_CHACHA20_POLY1305.*"

  - id: PCI-4.2.8
    name: Vulnerability-Free Configuration
    description: Server must not be vulnerable to known TLS/SSL attacks
    category: Vulnerability
    severity: critical
    remediation: |
      Patch or mitigate all known TLS/SSL vulnerabilities including:
      - Heartbleed (CVE-2014-0160)
      - POODLE (CVE-2014-3566)
      - BEAST (CVE-2011-3389)
      - CRIME (CVE-2012-4929)
      - FREAK (CVE-2015-0204)
      - Logjam (CVE-2015-4000)
      - DROWN (CVE-2016-0800)

      Keep TLS/SSL libraries and server software up to date.
    rules:
      - type: Vulnerability
